<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>tags:</title>
</head>

<body>
    <div id="wmd-preview" class="wmd-preview">
        <div class="md-section-divider"></div>
        <hr>
        <p data-anchor-id="t9x9">title: 基于canvas的碰撞检测 <br> date: 2017-03-07 17:43:39</p>
        <div class="md-section-divider"></div>
        <h2 data-anchor-id="gu5w" id="title"><code></code></h2>
        <p data-anchor-id="knj6">
            <div class="toc">
                <div class="toc">
                    <ul>
                        <li>
                            <ul>
                                <li></li>
                                <li><a href="#基于canvas的碰撞检测">基于canvas的碰撞检测</a>
                                    <ul>
                                        <li><a href="#一盒模型碰撞">一、盒模型碰撞</a>
                                            <ul>
                                                <li><a href="#1矩形与矩形的碰撞">1、矩形与矩形的碰撞</a></li>
                                                <li><a href="#2圆与圆的碰撞">2、圆与圆的碰撞</a></li>
                                            </ul>
                                        </li>
                                        <li><a href="#3圆与矩形的碰撞">3、圆与矩形的碰撞</a></li>
                                        <li><a href="#二分离轴定理">二、分离轴定理</a></li>
                                        <li><a href="#三像素检测">三、像素检测</a></li>
                                        <li><a href="#四其他方式">四、其他方式</a></li>
                                        <li><a href="#总结">总结</a></li>
                                    </ul>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </p>
        <div class="md-section-divider"></div>
        <h2 data-anchor-id="2yfd" id="基于canvas的碰撞检测">基于canvas的碰撞检测</h2>
        <div class="md-section-divider"></div>
        <h3 data-anchor-id="96g8" id="一盒模型碰撞">一、盒模型碰撞</h3>
        <div class="md-section-divider"></div>
        <h4 data-anchor-id="9ph2" id="1矩形与矩形的碰撞">1、矩形与矩形的碰撞</h4>
        <blockquote data-anchor-id="pijz" class="white-blockquote">
            <p><strong>核心公式：</strong><code>:A.x + A.w &gt;= B.x &amp;&amp; B.x + B.w &gt;= A.x &amp;&amp; A.y + A.h &gt;= B.y &amp;&amp; B.y + B.h &gt;= A.y</code></p>

            <p><strong>说明：</strong>矩形的碰撞检测就是检测边与边是否有碰撞或则是否矩形内部 <br>
                <br>
                <strong>图解(碰撞的情况)：</strong> <br>
                <br>
                <img src="https://misc.aotu.io/JChehe/2017-02-13-2d-collision-detection/rectangle_collision.png" alt=""></p>
        </blockquote>
        <p data-anchor-id="55y6"><br></p>
        <div class="md-section-divider"></div>
        <h4 data-anchor-id="try5" id="2圆与圆的碰撞">2、圆与圆的碰撞</h4>
        <blockquote data-anchor-id="uf8f" class="white-blockquote">
            <p><strong>核心公式：</strong><code>Math.sqrt(Math.pow(A.x - B.x, 2) + Math.pow(A.y - B.y, 2)) &lt;= A.r + B.r</code></p>
        </blockquote>
        <p data-anchor-id="gdqi"><strong>说明：</strong>圆形之间判断，需要判断圆与圆之间的距离是否大于2个圆的半径之和。</p>
        <p data-anchor-id="esp7"><strong>图解：</strong></p>
        <p data-anchor-id="2lol"><img src="https://misc.aotu.io/JChehe/2017-02-13-2d-collision-detection/circle_collision.png" alt=""> <br>
            <br> </p>
        <div class="md-section-divider"></div>
        <h3 data-anchor-id="58ka" id="3圆与矩形的碰撞">3、圆与矩形的碰撞</h3>
        <blockquote data-anchor-id="fahf" class="white-blockquote">
            <p><strong>核心思路:</strong>判断圆形是否与矩形四边碰撞并且矩形的四个角是否在园内即可</p>

            <p><strong>图解:</strong><img src="http://images2015.cnblogs.com/blog/803394/201511/803394-20151118023529749-1646683181.jpg" alt="图形判断"></p>
        </blockquote>
        <p data-anchor-id="2ctn"><br>
            <strong>代码如下:</strong></p>
        <div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="wvbp"><ol class="linenums"><li class="L0"><code class="language-javascript"><span class="pln">    </span><span class="com">/**</span></code></li><li class="L1"><code class="language-javascript"><span class="com">     * 检测圆形A和矩形B是否碰撞</span></code></li><li class="L2"><code class="language-javascript"><span class="com">     * @param A</span></code></li><li class="L3"><code class="language-javascript"><span class="com">     * @param B</span></code></li><li class="L4"><code class="language-javascript"><span class="com">     */</span></code></li><li class="L5"><code class="language-javascript"><span class="pln">    raTore</span><span class="pun">:</span><span class="pln"> </span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">A</span><span class="pun">,</span><span class="pln"> B</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L6"><code class="language-javascript"><span class="pln">      let x </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span></code></li><li class="L7"><code class="language-javascript"><span class="pln">      let y </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">max</span><span class="pun">(</span><span class="pln">B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">);</span></code></li><li class="L8"><code class="language-javascript"><span class="pln">      let w </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">w </span><span class="pun">+</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">canvas</span><span class="pun">.</span><span class="pln">width</span><span class="pun">);</span></code></li><li class="L9"><code class="language-javascript"><span class="pln">      let h </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">min</span><span class="pun">(</span><span class="pln">B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">h </span><span class="pun">+</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">canvas</span><span class="pun">.</span><span class="pln">height</span><span class="pun">);</span></code></li><li class="L0"><code class="language-javascript"><span class="pln">      </span><span class="com">//分别生成2个矩形,判断远圆心是否在2个矩形之内</span></code></li><li class="L1"><code class="language-javascript"><span class="pln">      let isInrect1 </span><span class="pun">=</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x </span><span class="pun">&gt;=</span><span class="pln"> x </span><span class="pun">&amp;&amp;</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x </span><span class="pun">&lt;=</span><span class="pln"> w </span><span class="pun">&amp;&amp;</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y </span><span class="pun">&gt;=</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">&amp;&amp;</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y </span><span class="pun">&lt;=</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">h</span><span class="pun">;</span></code></li><li class="L2"><code class="language-javascript"><span class="pln">      let isInrect2 </span><span class="pun">=</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x </span><span class="pun">&gt;=</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">&amp;&amp;</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x </span><span class="pun">&lt;=</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">w </span><span class="pun">&amp;&amp;</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y </span><span class="pun">&gt;=</span><span class="pln"> y </span><span class="pun">&amp;&amp;</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y </span><span class="pun">&lt;=</span><span class="pln"> h</span><span class="pun">;</span></code></li><li class="L3"><code class="language-javascript"><span class="pln">      </span><span class="com">//计算4个点是否在园内</span></code></li><li class="L4"><code class="language-javascript"><span class="pln">      let b1 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r </span><span class="pun">*</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">;</span></code></li><li class="L5"><code class="language-javascript"><span class="pln">      let b2 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">w </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r </span><span class="pun">*</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">;</span></code></li><li class="L6"><code class="language-javascript"><span class="pln">      let b3 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">h </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r </span><span class="pun">*</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">;</span></code></li><li class="L7"><code class="language-javascript"><span class="pln">      let b4 </span><span class="pun">=</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">x </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">w </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">x</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">+</span><span class="pln"> </span><span class="typ">Math</span><span class="pun">.</span><span class="pln">pow</span><span class="pun">((</span><span class="pln">B</span><span class="pun">.</span><span class="pln">y </span><span class="pun">+</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">h </span><span class="pun">-</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">y</span><span class="pun">),</span><span class="pln"> </span><span class="lit">2</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&lt;=</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r </span><span class="pun">*</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">r</span><span class="pun">;</span></code></li><li class="L8"><code class="language-javascript"><span class="pln">      </span><span class="com">// sx sy表示物体xy方向的速度，碰撞之后需要交换速度</span></code></li><li class="L9"><code class="language-javascript"><span class="pln">      </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">isInrect1 </span><span class="pun">||</span><span class="pln"> isInrect2 </span><span class="pun">||</span><span class="pln"> b1 </span><span class="pun">||</span><span class="pln"> b2 </span><span class="pun">||</span><span class="pln"> b3 </span><span class="pun">||</span><span class="pln"> b4</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L0"><code class="language-javascript"><span class="pln">        </span><span class="pun">[</span><span class="pln">A</span><span class="pun">.</span><span class="pln">sy</span><span class="pun">,</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">sy</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">B</span><span class="pun">.</span><span class="pln">sy</span><span class="pun">,</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">sy</span><span class="pun">];</span></code></li><li class="L1"><code class="language-javascript"><span class="pln">        </span><span class="pun">[</span><span class="pln">A</span><span class="pun">.</span><span class="pln">sx</span><span class="pun">,</span><span class="pln"> B</span><span class="pun">.</span><span class="pln">sx</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> </span><span class="pun">[</span><span class="pln">B</span><span class="pun">.</span><span class="pln">sx</span><span class="pun">,</span><span class="pln"> A</span><span class="pun">.</span><span class="pln">sx</span><span class="pun">];</span></code></li><li class="L2"><code class="language-javascript"><span class="pln">      </span><span class="pun">}</span></code></li><li class="L3"><code class="language-javascript"><span class="pln">    </span><span class="pun">},</span></code></li></ol></pre>
        <p data-anchor-id="vtyv"><br></p>
        <div class="md-section-divider"></div>
        <h3 data-anchor-id="8j6a" id="二分离轴定理">二、分离轴定理</h3>
        <blockquote data-anchor-id="8tq7" class="white-blockquote">
            <p><strong>起因：</strong>由于盒模型物体的碰撞检测都是基于规则物体（圆形或则矩形），无法试用其他多边形物体，那么多边形的碰撞咋办呢~</p>

            <p><strong>说明：</strong>假设2个不规则物体有所接触（碰撞），那么必然存在一个方向 的投影（可以想想成太阳照射产生的影子）会重合,即 <strong>若在某一角度光源下，两物体的投影存在间隙，则为不碰撞，否则为发生碰撞</strong></p>
        </blockquote>
        <p data-anchor-id="oifp"><strong>图解：</strong> <br>
            <img src="https://misc.aotu.io/JChehe/2017-02-13-2d-collision-detection/sat_base.png" alt=""></p>
        <blockquote data-anchor-id="zucv" class="white-blockquote">
            <p>在程序中，遍历所有角度是不现实的。那如何确定 投影轴呢？其实投影轴的数量与多边形的边数相等即可。</p>
        </blockquote>
        <p data-anchor-id="xi2u"><img src="https://misc.aotu.io/JChehe/2017-02-13-2d-collision-detection/sat_projection_two.png" alt=""></p>
        <p data-anchor-id="dmwa"><br>
            <strong>抽取整个过程:</strong></p>
        <blockquote data-anchor-id="mczw" class="white-blockquote">
            <p>1、获取多边形所有投影轴 <br> 2、遍历投影轴获取投影 <br> 3、判断投影是否存在间隙,如果是则不碰撞
            </p>
        </blockquote>
        <p data-anchor-id="s82v"><br>
            <strong>涉及的向量知识</strong></p>
        <blockquote data-anchor-id="uug0" class="white-blockquote">
            <p>1、向量表示法:AB或则a或则{x,y} <br> 2、向量的垂直向量的算法:假如原有向量为{x,y},垂直向量为{m,n},则xm+ny=0;也就是说{x,y}的垂直向量为{-y,x}k或则{x,-y}K <br> 3、向量的点积运算:A*B = x1y1+x2y2 = |A||B|cos0</p>
        </blockquote>
        <p data-anchor-id="mnbh"><br>
            <strong>demo地址：</strong></p>
        <blockquote data-anchor-id="a4j7" class="white-blockquote">
            <p><a href="https://github.com/xxyj/wuec" target="_blank">https://github.com/xxyj/wuec</a></p>
        </blockquote>
        <p data-anchor-id="pbnu"><br></p>
        <div class="md-section-divider"></div>
        <h3 data-anchor-id="lg5y" id="三像素检测">三、像素检测</h3>
        <p data-anchor-id="tr6j">疑问：分离轴定理只适用于凸多边形，那么凹多边形又该如何处理呢？？？</p>
        <blockquote data-anchor-id="udcw" class="white-blockquote">
            <p>像素检测原理：检测2个物体在同一像素是否有覆盖,有则碰撞,无则不碰撞 <br> 关键函数：
                <a href="http://www.w3school.com.cn/tags/canvas_getimagedata.asp" target="_blank">getImageData</a>,<a href="http://www.w3school.com.cn/tags/canvas_globalcompositeoperation.asp" target="_blank">globalCompositeOperation</a>(两者使用其一即可)，
                <br> 使用原理：通过函数计算两个物体在同一个像素点的透明度，然后通过该像素点的实际透明情况来判断是否有碰撞。具体参考：
                <a href="https://github.com/xxyj/wuec" target="_blank">demo</a></p>
        </blockquote>
        <p data-anchor-id="i1j0"><br> 核心代码
        </p>
        <div class="md-section-divider"></div><pre class="prettyprint linenums prettyprinted" data-anchor-id="x1g2"><ol class="linenums"><li class="L0"><code class="language-javascript"><span class="pln">      </span><span class="com">//需要创建一个离线canvas</span></code></li><li class="L1"><code class="language-javascript"><span class="pln">      let canvas </span><span class="pun">=</span><span class="pln"> document</span><span class="pun">.</span><span class="pln">createElement</span><span class="pun">(</span><span class="str">"canvas"</span><span class="pun">);</span></code></li><li class="L2"><code class="language-javascript"><span class="pln">      let ctx </span><span class="pun">=</span><span class="pln"> canvas</span><span class="pun">.</span><span class="pln">getContext</span><span class="pun">(</span><span class="str">"2d"</span><span class="pun">);</span></code></li><li class="L3"><code class="language-javascript"><span class="pln">      ctx</span><span class="pun">.</span><span class="pln">drawImage</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">offImage</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">canvas</span><span class="pun">.</span><span class="pln">width</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">canvas</span><span class="pun">.</span><span class="pln">height</span><span class="pun">);</span></code></li><li class="L4"><code class="language-javascript"><span class="pln">      </span><span class="com">//如果有交集，交集处的显示方式</span></code></li><li class="L5"><code class="language-javascript"><span class="pln">      ctx</span><span class="pun">.</span><span class="pln">globalCompositeOperation </span><span class="pun">=</span><span class="pln"> </span><span class="str">'destination-in'</span><span class="pun">;</span></code></li><li class="L6"><code class="language-javascript"><span class="pln">       ctx</span><span class="pun">.</span><span class="pln">drawImage</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">imgObject</span><span class="pun">[</span><span class="lit">4</span><span class="pun">],</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">x</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">y</span><span class="pun">,</span><span class="pln"> </span><span class="lit">27</span><span class="pun">,</span><span class="pln"> </span><span class="lit">41</span><span class="pun">);</span></code></li><li class="L7"><code class="language-javascript"><span class="pln">      let data </span><span class="pun">=</span><span class="pln"> ctx</span><span class="pun">.</span><span class="pln">getImageData</span><span class="pun">(</span><span class="typ">Math</span><span class="pun">.</span><span class="pln">abs</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">.</span><span class="pln">x</span><span class="pun">)</span><span class="pln"> </span><span class="pun">-</span><span class="pln"> </span><span class="lit">28</span><span class="pun">,</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> </span><span class="lit">56</span><span class="pun">,</span><span class="pln"> </span><span class="lit">30</span><span class="pun">).</span><span class="pln">data</span><span class="pun">;</span></code></li><li class="L8"><code class="language-javascript"><span class="pln">      canvas </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span></code></li><li class="L9"><code class="language-javascript"><span class="pln">      ctx </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">;</span></code></li><li class="L0"><code class="language-javascript"><span class="pln">      </span><span class="com">//判断每个像素点的透明度</span></code></li><li class="L1"><code class="language-javascript"><span class="pln">      </span><span class="kwd">return</span><span class="pln"> data</span><span class="pun">.</span><span class="pln">some</span><span class="pun">(</span><span class="kwd">function</span><span class="pln"> </span><span class="pun">(</span><span class="pln">item</span><span class="pun">,</span><span class="pln"> index</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="language-javascript"><span class="pln">        </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">(</span><span class="pln">index </span><span class="pun">+</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span><span class="pln"> </span><span class="pun">%</span><span class="pln"> </span><span class="lit">4</span><span class="pln"> </span><span class="pun">===</span><span class="pln"> </span><span class="lit">0</span><span class="pln"> </span><span class="pun">&amp;&amp;</span><span class="pln"> item </span><span class="pun">!==</span><span class="pln"> </span><span class="lit">0</span><span class="pun">;</span></code></li><li class="L3"><code class="language-javascript"><span class="pln">      </span><span class="pun">})</span></code></li><li class="L4"><code class="language-javascript"><span class="pln">      </span><span class="kwd">return</span><span class="pln"> </span><span class="kwd">false</span><span class="pun">;</span></code></li></ol></pre>
        <p data-anchor-id="nyf0"><br></p>
        <div class="md-section-divider"></div>
        <h3 data-anchor-id="em3a" id="四其他方式">四、其他方式</h3>
        <p data-anchor-id="ukc7">疑问：像素检测非常的消耗性能，如果需要计算的面积非常的大，该如何处理？</p>
        <blockquote data-anchor-id="eeyi" class="white-blockquote">
            <p>关键函数：<a href="http://www.w3school.com.cn/tags/canvas_ispointinpath.asp" target="_blank">isPointInPath</a>(判断一个点是否在当前路径中),使用起来非常简单 <br> 具体的 还是看<a href="https://github.com/xxyj/wuec" target="_blank">demo</a>吧</p>
        </blockquote>
        <p data-anchor-id="3qlk"><br></p>
        <div class="md-section-divider"></div>
        <h3 data-anchor-id="hww3" id="总结">总结</h3>
        <blockquote data-anchor-id="acts" class="white-blockquote">
            <p>碰撞检测的方式非常的多，各有优劣，实际使用过程中还是需要混合使用，比如说：我们一般可以在面积比较大的时候使用盒模型碰撞（将一些不规则物体先假设成矩形或则圆），确定出可能碰撞的小区域之后再使用像素检测来进行精确判断!</p>
        </blockquote>
    </div>
</body>

</html>